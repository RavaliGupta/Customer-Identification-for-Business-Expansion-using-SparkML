<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>Dinidng Donors for charityML - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/f12a05aa7eae95a2da8fd637b50b850a1bb31a04ce331f5b43445dd4cda0ff19/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/f12a05aa7eae95a2da8fd637b50b850a1bb31a04ce331f5b43445dd4cda0ff19/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/f12a05aa7eae95a2da8fd637b50b850a1bb31a04ce331f5b43445dd4cda0ff19/img/favicon.ico"/>
<script>window.settings = {"enableUsageDeliveryConfiguration":false,"enableNotebookNotifications":true,"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableClusterMetricsUI":true,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableReservoirTableUI":false,"enableClearStateFeature":true,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"enableAttachExistingCluster":true,"resetJobListOnConnect":true,"serverlessDefaultSparkVersion":"latest-stable-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":14,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":0,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"sqlAclsDisabledMap":{"spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"serverlessClusterProductName":"Serverless Pool","showS3TableImportOption":true,"maxEbsVolumesPerInstance":10,"enableRStudioUI":false,"isAdmin":true,"deltaProcessingBatchSize":1000,"timerUpdateQueueLength":100,"sqlAclsEnabledMap":{"spark.databricks.acl.enabled":"true","spark.databricks.acl.sqlOnly":"true"},"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"serverlessClustersEnabled":false,"enableWorkspaceBrowserSorting":true,"enableSentryLogging":false,"enableFindAndReplace":true,"disallowUrlImportExceptFromDocs":false,"defaultStandardClusterModel":{"cluster_name":"","node_type_id":"dev-tier-node","spark_version":"3.5.x-scala2.11","num_workers":0,"aws_attributes":{"first_on_demand":0,"availability":"ON_DEMAND","zone_id":"us-west-2c","spot_bid_price_percent":100},"autotermination_minutes":120,"default_tags":{"Vendor":"Databricks","Creator":"mamidiravali1@gmail.com","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableBitbucketCloud":true,"createTableInNotebookS3Link":{"url":"https://docs.databricks.com/_static/notebooks/data-import/s3.html","displayName":"S3","workspaceFileName":"S3 Example"},"sanitizeHtmlResult":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"useAutoscalingByDefault":false,"enableAzureToolbar":false,"fileStoreBase":"FileStore","enableEmailInAzure":false,"enableRLibraries":true,"enableTableAclsConfig":false,"enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"checkBeforeAddingAadUser":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"createTableInNotebookDBFSLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/dbfs.html","displayName":"DBFS","workspaceFileName":"DBFS Example"},"perClusterAutoterminationEnabled":false,"enableNotebookCommandNumbers":true,"allowStyleInSanitizedHtml":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.3.x-gpu-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-86b4917bb6586289ca64e65f64fd23678c297274be6cd6aa6aa01d7b91fed29c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.10","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d7df74e188103a4093ff4467dbf0d32886366c984097f6997e0cd87d0f6b2fa5","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1, deprecated)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db6-scala2.10","displayName":"Spark 2.1.1-db6 (Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-scala2.11","displayName":"4.0 beta (Scala 2.11)","packageLabel":"spark-image-89788fbfd72ee629971a68a6cea9a465c8b4d040bbd577a2e7dd5613af0045c4","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-d613235f93e0f29838beb2079a958c02a192ed67a502192bc67a8a5f2fb37f35","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"latest-stable-gpu-scala2.11","displayName":"Latest stable (3.5 LTS, GPU, Scala 2.11)","packageLabel":"spark-image-71e2fd18fdbbb732d6adec03e171846687b6ec85a572e5931e8a9ed9b62e7c32","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-a5615cb1adf0d2305f2b93188c6720174ec3e782d100fcbfa96ff870392861df","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.2.x-scala2.10","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-557788bea0eea16bbf7a8ba13ace07e64dd7fc86270bd5cea086097fe886431f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"latest-experimental-scala2.10","displayName":"Latest experimental (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"4.0.x-gpu-scala2.11","displayName":"4.0 beta (GPU, Scala 2.11)","packageLabel":"spark-image-e00d97c0ffe46ea0ffd62dad605d0e58df62cc73581e5e2c82d85ecf10ab010c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.11","displayName":"Latest RC (4.0, Scala 2.11)","packageLabel":"spark-image-89788fbfd72ee629971a68a6cea9a465c8b4d040bbd577a2e7dd5613af0045c4","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-stable-scala2.11","displayName":"Latest stable (3.5 LTS, Scala 2.11)","packageLabel":"spark-image-4f5f9fb3a7177ac43f84a20f819e8ad76833e356707ed0b79812a2f837ac0a06","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"next-major-version-scala2.11","displayName":"Next major version (4.0 snapshot, Scala 2.11)","packageLabel":"spark-image-89788fbfd72ee629971a68a6cea9a465c8b4d040bbd577a2e7dd5613af0045c4","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.5.x-scala2.10","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.10)","packageLabel":"spark-image-fff24a42ff1d42290166196e45860557b34d4af8a5e6e794857bd999865393fb","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.10","displayName":"Latest RC (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-stable-scala2.10","displayName":"Latest stable (3.5 LTS, Scala 2.10)","packageLabel":"spark-image-fff24a42ff1d42290166196e45860557b34d4af8a5e6e794857bd999865393fb","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-gpu-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-613a129fcaa93423a4de06407c9f93e341ed5c6b02d69179d2703c8bb47e2b99","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1, deprecated)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"latest-experimental-gpu-scala2.11","displayName":"Latest experimental (4.1 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-efdf094d778ece3493e9f328c6c87451eb38fb3fedea7facd8953548c76e56da","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.0.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.1.x-scala2.11","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-241fa8b78ee6343242b1756b18076270894385ff40a81172a6fb5eadf66155d3","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.1.x-scala2.10","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-7efac6b9a8f2da59cb4f6d0caac46cfcb3f1ebf64c8073498c42d0360f846714","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-0badc3d8dfc8cddd55795d02c0b31c76330cfe687d588414f91278197fbc9416","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"next-major-version-gpu-scala2.11","displayName":"Next major version (4.0 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-e00d97c0ffe46ea0ffd62dad605d0e58df62cc73581e5e2c82d85ecf10ab010c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-gpu-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, GPU, Scala 2.11)","packageLabel":"spark-image-71e2fd18fdbbb732d6adec03e171846687b6ec85a572e5931e8a9ed9b62e7c32","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1, deprecated)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db6-scala2.11","displayName":"Spark 2.1.1-db6 (Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-4f5f9fb3a7177ac43f84a20f819e8ad76833e356707ed0b79812a2f837ac0a06","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-experimental-scala2.11","displayName":"Latest experimental (4.1 snapshot, Scala 2.11)","packageLabel":"spark-image-55ff3150d7a546de7f283c6d62d9e6e0b22e060159282693456a190e706b31aa","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.2.x-scala2.11","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-5537926238bc55cb6cd76ee0f0789511349abead3781c4780721a845f34b5d4e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.0.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-gpu-scala2.11","displayName":"Latest RC (4.0, gpu-scala 2.11)","packageLabel":"spark-image-e00d97c0ffe46ea0ffd62dad605d0e58df62cc73581e5e2c82d85ecf10ab010c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-scala2.10","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-b768d65de82a89fbfabff8ec1d2f279ced527c0ec05e83c3ae0c206d2e97edc0","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]}],"enablePresentationMode":false,"enableClearStateAndRunAll":true,"enableTableAclsByTier":false,"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"jobsUnreachableThresholdMillis":60000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"createTableInNotebookImportedFileLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/imported-file.html","displayName":"Imported File","workspaceFileName":"Imported File Example"},"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","tableAclsDisabledMap":{"spark.databricks.acl.dfAclsEnabled":"false"},"driverStdoutFilePrefix":"stdout","showDbuPricing":true,"databricksDocsBaseHostname":"docs.databricks.com","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"i3.4xlarge":4,"class-node":1,"m4.2xlarge":1.5,"r4.xlarge":1,"m4.4xlarge":3,"Standard_DS5_v2":3,"Standard_D2s_v3":0.5,"Standard_DS14":4,"r4.16xlarge":16,"Standard_DS11":0.5,"Standard_D64s_v3":12,"p2.8xlarge":16,"m4.10xlarge":8,"Standard_D8s_v3":1.5,"Standard_E32s_v3":8,"Standard_DS3":0.75,"Standard_DS2_v2":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"Standard_L8s":2,"Standard_E4s_v3":1,"Standard_D3_v2":0.75,"Standard_DS15_v2":5,"Standard_D16s_v3":3,"Standard_D5_v2":3,"Standard_E8s_v3":2,"c3.8xlarge":4,"Standard_E2s_v3":0.5,"Standard_DS3_v2":0.75,"r3.4xlarge":4,"Standard_DS4":1.5,"i2.4xlarge":6,"m4.xlarge":0.75,"r4.8xlarge":8,"Standard_H16":4,"Standard_DS14_v2":4,"r4.large":0.5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"i3.large":0.75,"memory-optimized":1,"m4.large":0.4,"Standard_F4s":0.5,"p2.16xlarge":24,"i3.8xlarge":8,"Standard_D32s_v3":6,"i3.16xlarge":16,"Standard_DS12_v2":1,"Standard_L32s":8,"Standard_D4s_v3":0.75,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS13_v2":2,"c3.2xlarge":1,"Standard_L4s":1,"Standard_F16s":2,"c4.2xlarge":1,"Standard_L16s":4,"i2.xlarge":1.5,"Standard_DS2":0.5,"compute-optimized":1,"c4.4xlarge":2,"Standard_D2_v2":0.5,"i3.2xlarge":2,"Standard_E16s_v3":4,"Standard_F8s":1,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":12,"Standard_DS4_v2":1.5,"c4.8xlarge":4,"i3.xlarge":1,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"tableFilesBaseFolder":"/tables","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableClusterAppsUIOnServerless":false,"enableEBSVolumesUI":false,"homePageWelcomeMessage":"Welcome to ","metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.65.961","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"useAADLogin":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":true,"enableStrongPassword":false,"showReleaseNote":true,"displayDefaultContainerMemoryGB":6,"broadenedEditPermission":false,"enableNotebookCommandMode":true,"disableS3TableImport":false,"enableArrayParamsEdit":true,"deploymentMode":"production","useSpotForWorkers":true,"removePasswordInAccountSettings":false,"preferStartTerminatedCluster":false,"enableUserInviteWorkflow":true,"createTableConnectorOptionLinks":[{"url":"https://docs.databricks.com/_static/notebooks/redshift.html","displayName":"Amazon Redshift","workspaceFileName":"Amazon Redshift Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-kinesis.html","displayName":"Amazon Kinesis","workspaceFileName":"Amazon Kinesis Example"},{"url":"https://docs.databricks.com/_static/notebooks/data-import/jdbc.html","displayName":"JDBC","workspaceFileName":"JDBC Example"},{"url":"https://docs.databricks.com/_static/notebooks/cassandra.html","displayName":"Cassandra","workspaceFileName":"Cassandra Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-etl-kafka.html","displayName":"Kafka","workspaceFileName":"Kafka Example"},{"url":"https://docs.databricks.com/_static/notebooks/redis.html","displayName":"Redis","workspaceFileName":"Redis Example"},{"url":"https://docs.databricks.com/_static/notebooks/elasticsearch.html","displayName":"Elasticsearch","workspaceFileName":"Elasticsearch Example"}],"enableStaticNotebooks":true,"sandboxForUrlSandboxFrame":"allow-scripts allow-popups allow-popups-to-escape-sandbox allow-forms","enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterEdit":true,"enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"enableCreateClusterOnAttach":true,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"defaultMinWorkers":2,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"defaultMaxWorkers":8,"enableWorkspaceAclsConfig":false,"serverlessRunPythonAsLowPrivilegeUser":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":true,"enableNewDashboardViews":true,"enableJobListPermissionFilter":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-4f5f9fb3a7177ac43f84a20f819e8ad76833e356707ed0b79812a2f837ac0a06","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},"deprecatedEnableStructuredDataAcls":false,"enableCustomSpotPricing":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":120,"useDevTierHomePage":true,"disableExportNotebook":false,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableNotebookDatasetInfoView":true,"defaultTagKeys":{"CLUSTER_NAME":"ClusterName","VENDOR":"Vendor","CLUSTER_TYPE":"ResourceClass","CREATOR":"Creator","CLUSTER_ID":"ClusterId"},"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","azurePortalLink":"https://portal.azure.com","cloud":"AWS","customSparkVersionPrefix":"custom:","disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","defaultServerlessClusterModel":{"cluster_name":"","node_type_id":"i3.2xlarge","spark_version":"latest-stable-scala2.11","num_workers":null,"enable_jdbc_auto_start":true,"custom_tags":{"ResourceClass":"Serverless"},"autoscale":{"min_workers":2,"max_workers":20},"spark_conf":{"spark.databricks.cluster.profile":"serverless","spark.databricks.repl.allowedLanguages":"sql,python,r","spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"aws_attributes":{"ebs_volume_count":null,"availability":"ON_DEMAND","first_on_demand":1,"ebs_volume_type":null,"spot_bid_price_percent":100,"zone_id":"us-west-2c","ebs_volume_size":null},"autotermination_minutes":0,"enable_elastic_disk":false,"default_tags":{"Vendor":"Databricks","Creator":"mamidiravali1@gmail.com","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableOrgSwitcherUI":true,"bitbucketCloudBaseApiV2Url":"https://api.bitbucket.org/2.0","clustersLimit":1,"enableJdbcImport":true,"enableClusterAppsUIOnNormalClusters":false,"enableElasticDisk":false,"logfiles":"logfiles/","enableRelativeNotebookLinks":true,"enableMultiSelect":true,"homePageLogo":"login/databricks_logoTM_rgb_TM.svg","enableWebappSharding":true,"enableNotebookParamsEdit":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"separateTableForJobClusters":true,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"enableRServerless":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"showVersion":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"","clusterTagReservedPrefixes":[],"tableAclsEnabledMap":{"spark.databricks.acl.dfAclsEnabled":"true"},"showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","databricksDocsNotebookPathPrefix":"^https://docs\\.databricks\\.com/_static/notebooks/.+$","serverlessAttachEbsVolumesByDefault":false,"enableTokensConfig":false,"allowFeedbackForumAccess":true,"enablePythonVersionUI":true,"enableImportFromUrl":true,"allowDisplayHtmlByUrl":true,"enableTokens":false,"enableMiniClusters":true,"enableNewJobList":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"loginLogo":"/login/databricks_logoTM_rgb_TM.svg","useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/f12a05aa7eae95a2da8fd637b50b850a1bb31a04ce331f5b43445dd4cda0ff19/","enableSpotClusterType":true,"enableSparkPackages":true,"checkAadUserInWorkspaceTenant":false,"dynamicSparkVersions":true,"useIframeForHtmlResult":false,"enableClusterTagsUIByTier":false,"enableNotebookHistoryUI":true,"addWhitespaceAfterLastNotebookCell":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":false,"maxImportFileVersion":5,"enableEBSVolumesUIByTier":false,"enableTableAclService":true,"removeSubCommandCodeWhenExport":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","maxAutoterminationMinutes":10000,"showResultsFromExternalSearchEngine":true,"autoterminateClustersByDefault":true,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"showForgotPasswordLink":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"enableAutoCreateUserUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":601698659811114,"name":"Dinidng Donors for charityML","language":"python","commands":[{"version":"CommandV1","origId":601698659811115,"guid":"2bd81689-7759-4679-8e5d-f797ab91a3de","subtype":"command","commandType":"auto","position":1.0,"command":"from pyspark.sql import SparkSession\nspark = SparkSession.builder.appName('income_pred').getOrCreate()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519522437579,"submitTime":1519522432930,"finishTime":1519522437650,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1462d7a4-d4e3-4aff-86af-32255c76d2eb"},{"version":"CommandV1","origId":601698659811117,"guid":"973f5f75-ecb0-44b3-bd60-58f17b39ad24","subtype":"command","commandType":"auto","position":2.0,"command":"donor_df = spark.read.csv('/FileStore/tables/income_census.csv',inferSchema=True,header=True)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: csv() got an unexpected keyword argument &apos;infreSchema&apos;","error":null,"workflows":[],"startTime":1519522437653,"submitTime":1519522433064,"finishTime":1519522438476,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0a71c179-bb60-49cc-adb4-457573b758db"},{"version":"CommandV1","origId":601698659811118,"guid":"3479e78b-9c32-42a1-8614-725674d61d14","subtype":"command","commandType":"auto","position":3.0,"command":"donor_df.printSchema()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- age: integer (nullable = true)\n |-- workclass: string (nullable = true)\n |-- education_level: string (nullable = true)\n |-- education-num: integer (nullable = true)\n |-- marital-status: string (nullable = true)\n |-- occupation: string (nullable = true)\n |-- relationship: string (nullable = true)\n |-- race: string (nullable = true)\n |-- sex: string (nullable = true)\n |-- capital-gain: integer (nullable = true)\n |-- capital-loss: integer (nullable = true)\n |-- hours-per-week: integer (nullable = true)\n |-- native-country: string (nullable = true)\n |-- income: string (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519522438479,"submitTime":1519522433205,"finishTime":1519522438502,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ab79d9ec-2cb2-4e74-9cdf-92977f9d9507"},{"version":"CommandV1","origId":601698659811119,"guid":"db8b280a-7298-49da-a613-5eb552473550","subtype":"command","commandType":"auto","position":4.0,"command":"donor_df.show(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+-----------------+---------------+-------------+-------------------+------------------+--------------+------+-------+------------+------------+--------------+--------------+------+\n|age|        workclass|education_level|education-num|     marital-status|        occupation|  relationship|  race|    sex|capital-gain|capital-loss|hours-per-week|native-country|income|\n+---+-----------------+---------------+-------------+-------------------+------------------+--------------+------+-------+------------+------------+--------------+--------------+------+\n| 39|        State-gov|      Bachelors|           13|      Never-married|      Adm-clerical| Not-in-family| White|   Male|        2174|           0|            40| United-States| &lt;=50K|\n| 50| Self-emp-not-inc|      Bachelors|           13| Married-civ-spouse|   Exec-managerial|       Husband| White|   Male|           0|           0|            13| United-States| &lt;=50K|\n| 38|          Private|        HS-grad|            9|           Divorced| Handlers-cleaners| Not-in-family| White|   Male|           0|           0|            40| United-States| &lt;=50K|\n| 53|          Private|           11th|            7| Married-civ-spouse| Handlers-cleaners|       Husband| Black|   Male|           0|           0|            40| United-States| &lt;=50K|\n| 28|          Private|      Bachelors|           13| Married-civ-spouse|    Prof-specialty|          Wife| Black| Female|           0|           0|            40|          Cuba| &lt;=50K|\n+---+-----------------+---------------+-------------+-------------------+------------------+--------------+------+-------+------------+------------+--------------+--------------+------+\nonly showing top 5 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519522438505,"submitTime":1519522433349,"finishTime":1519522438626,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9802058a-a1ab-43f7-8e05-ff6a4f276c87"},{"version":"CommandV1","origId":4401295299595941,"guid":"b58f2b9c-defe-42e5-bb5f-5abf1a011fd3","subtype":"command","commandType":"auto","position":4.5,"command":"donor_df = donor_df.filter(donor_df.income.isNotNull())","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519522438629,"submitTime":1519522433500,"finishTime":1519522438668,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"94d81ac0-54cb-43a4-a16f-9c065094b343"},{"version":"CommandV1","origId":4401295299595942,"guid":"bb1773dd-90bf-4dbb-84ab-48ca19f007ac","subtype":"command","commandType":"auto","position":4.5,"command":"donor_df = donor_df.filter(donor_df.income.isNotNull())\ndonor_df = donor_df.withColumn('income',f.regexp_replace('income','>50K.','>50K')).withColumn('income',f.regexp_replace('income','<=50K.','<=50K'))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519522438671,"submitTime":1519522433509,"finishTime":1519522438741,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"74031611-d765-4b6c-8d34-9bb568acadf7"},{"version":"CommandV1","origId":601698659811120,"guid":"41aa361a-a0ad-4761-88b6-73277c3f0659","subtype":"command","commandType":"auto","position":5.0,"command":"### Total number of records in the dataset\ntotal_recs = donor_df.count()\nincome_abv50 = donor_df.filter(donor_df.income == '>50K').count()\nperc_income = (income_abv50/float(total_recs))*100\nprint('Total number of records in the dataset {}'.format(total_recs))\nprint('Number of individual records whose income is greater than $50000 : {}'.format(income_abv50))\nprint('Number of individual records whose income is  less than $50000 : {}'.format(donor_df.filter(donor_df.income == '<=50K').count()))\nprint('Percentage of individuals making more than $50,000 : {0:.2f}%'.format(perc_income))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Total number of records in the dataset 48842\nNumber of individual records whose income is greater than $50000 : 0\nNumber of individual records whose income is  less than $50000 : 0\nPercentage of individuals making more than $50,000 : 0.00%\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: &apos;Column&apos; object is not callable","error":null,"workflows":[],"startTime":1519522438744,"submitTime":1519522433629,"finishTime":1519522439753,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"895f8ea3-3a3b-451b-8d07-a17cf4cf28e4"},{"version":"CommandV1","origId":601698659811121,"guid":"91dd312d-a0c5-4dd7-859f-8cc8bc5dbd0e","subtype":"command","commandType":"auto","position":6.0,"command":"### Starting to preprocess the data. Renaming the columns in to usable format.\ndonor_df = donor_df.withColumnRenamed('education-num','education_num').withColumnRenamed('marital-status','marital_status').withColumnRenamed('capital-gain','capital_gain').withColumnRenamed('capital-loss','capital_loss').withColumnRenamed('hours-per-week','hours_per_week').withColumnRenamed('native-country','native_country')\n\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: Column is not iterable","error":null,"workflows":[],"startTime":1519522439756,"submitTime":1519522433753,"finishTime":1519522439878,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"736a67db-ed25-489a-a8db-0f46e495ab66"},{"version":"CommandV1","origId":601698659811122,"guid":"1e48c209-0db4-4e3e-aa4b-6922a50f4e4b","subtype":"command","commandType":"auto","position":7.0,"command":"max_capital_gain = donor_df.agg({\"capital_gain\": \"max\"}).collect()[0]\nmax_capital_gain = max_capital_gain['max(capital_gain)']\nmin_capital_gain = donor_df.agg({'capital_gain':'min'}).collect()[0]\nmin_capital_gain = min_capital_gain['min(capital_gain)']\nmax_capital_loss = donor_df.agg({'capital_loss':'max'}).collect()[0]\nmax_capital_loss = max_capital_loss['max(capital_loss)']\nmin_capital_loss = donor_df.agg({'capital_loss':'min'}).collect()[0]\nmin_capital_loss = min_capital_loss['min(capital_loss)']\nprint('Max and min values of capital-gain feature {} and {}'.format(max_capital_gain,min_capital_gain))\nprint('Max and min values of capital-loss feature {} and {}'.format(max_capital_loss,min_capital_loss))\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Max and min values of capital-gain feature 99999 and 0\nMax and min values of capital-loss feature 4356 and 0\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> can&apos;t assign to operator","error":null,"workflows":[],"startTime":1519522439881,"submitTime":1519522433865,"finishTime":1519522440806,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0ee8b3ee-f607-4844-9e67-b7814f0b4678"},{"version":"CommandV1","origId":601698659811125,"guid":"0018b91d-6db1-47ba-876c-4c02f0634c89","subtype":"command","commandType":"auto","position":10.0,"command":"### Applying log transformations on capital_gain and capital_loss features.\nimport pyspark.sql.functions as f\ndonor_df= donor_df.withColumn('capital_gain',f.log(donor_df.capital_gain + 1))\ndonor_df= donor_df.withColumn('capital_loss',f.log(donor_df.capital_loss + 1))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;f&apos; is not defined","error":null,"workflows":[],"startTime":1519522440812,"submitTime":1519522433999,"finishTime":1519522440888,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":true,"iPythonMetadata":null,"streamStates":{},"nuid":"3e9b9e5b-6e89-4425-b0a9-16d5a4071f4a"},{"version":"CommandV1","origId":601698659811128,"guid":"0d83853a-db8c-4e45-93d8-ebb6d9443132","subtype":"command","commandType":"auto","position":12.0,"command":"## Applying the data transformation on other numeric features that is age,education_num, hours_per_week, capital_gain, capital_loss\n\nfrom pyspark.ml.feature import StringIndexer, VectorAssembler, OneHotEncoder\n\nmax_education_num , min_education_num = donor_df.select(f.max('education_num'), f.min('education_num')).first()\nmax_age, min_age = donor_df.select(f.max(\"age\"), f.min(\"age\")).first()\nmax_capital_gain, min_capital_gain = donor_df.select(f.max('capital_gain'),f.min('capital_gain')).first()\nmax_capital_loss , min_capital_loss = donor_df.select(f.max('capital_loss'), f.min('capital_loss')).first()\nmax_hours_per_week , min_hours_per_week = donor_df.select(f.max('hours_per_week'), f.min('hours_per_week')).first()\n\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519522440891,"submitTime":1519522434164,"finishTime":1519522442102,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dc60e918-fcd4-4dcc-8407-7d37ed901f31"},{"version":"CommandV1","origId":601698659811129,"guid":"baf47773-8732-4bc0-b8b2-3e7361990459","subtype":"command","commandType":"auto","position":13.0,"command":"donor_df = donor_df.withColumn('age',(donor_df.age - min_age/max_age - min_age))\ndonor_df = donor_df.withColumn('capital_loss',(donor_df.capital_loss- min_capital_loss/max_capital_loss - min_capital_loss))\ndonor_df = donor_df.withColumn('capital_gain',(donor_df.capital_gain- min_capital_gain/max_capital_gain - min_capital_gain))\ndonor_df = donor_df.withColumn('hours_per_week',(donor_df.hours_per_week- min_hours_per_week/max_hours_per_week - min_hours_per_week))\ndonor_df = donor_df.withColumn('education_num',(donor_df.education_num - min_education_num/max_education_num - min_education_num))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: unsupported operand type(s) for /: &apos;NoneType&apos; and &apos;NoneType&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-123-5fc6b3b81fb7&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> donor_df <span class=\"ansiyellow\">=</span> donor_df<span class=\"ansiyellow\">.</span>withColumn<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;age&apos;</span><span class=\"ansiyellow\">,</span><span class=\"ansiyellow\">(</span>donor_df<span class=\"ansiyellow\">.</span>age <span class=\"ansiyellow\">-</span> min_age<span class=\"ansiyellow\">/</span>max_age <span class=\"ansiyellow\">-</span> min_age<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> donor_df <span class=\"ansiyellow\">=</span> donor_df<span class=\"ansiyellow\">.</span>withColumn<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;capital_loss&apos;</span><span class=\"ansiyellow\">,</span><span class=\"ansiyellow\">(</span>donor_df<span class=\"ansiyellow\">.</span>capital_loss<span class=\"ansiyellow\">-</span> min_capital_loss<span class=\"ansiyellow\">/</span>max_capital_loss <span class=\"ansiyellow\">-</span> min_capital_loss<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 3</span><span class=\"ansiyellow\"> </span>donor_df <span class=\"ansiyellow\">=</span> donor_df<span class=\"ansiyellow\">.</span>withColumn<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;capital_gain&apos;</span><span class=\"ansiyellow\">,</span><span class=\"ansiyellow\">(</span>donor_df<span class=\"ansiyellow\">.</span>capital_gain<span class=\"ansiyellow\">-</span> min_capital_gain<span class=\"ansiyellow\">/</span>max_capital_gain <span class=\"ansiyellow\">-</span> min_capital_gain<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> donor_df <span class=\"ansiyellow\">=</span> donor_df<span class=\"ansiyellow\">.</span>withColumn<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;hours_per_week&apos;</span><span class=\"ansiyellow\">,</span><span class=\"ansiyellow\">(</span>donor_df<span class=\"ansiyellow\">.</span>hours_per_week<span class=\"ansiyellow\">-</span> min_hours_per_week<span class=\"ansiyellow\">/</span>max_hours_per_week <span class=\"ansiyellow\">-</span> min_hours_per_week<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> donor_df <span class=\"ansiyellow\">=</span> donor_df<span class=\"ansiyellow\">.</span>withColumn<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;education_num&apos;</span><span class=\"ansiyellow\">,</span><span class=\"ansiyellow\">(</span>donor_df<span class=\"ansiyellow\">.</span>education_num <span class=\"ansiyellow\">-</span> min_education_num<span class=\"ansiyellow\">/</span>max_education_num <span class=\"ansiyellow\">-</span> min_education_num<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: unsupported operand type(s) for /: &apos;NoneType&apos; and &apos;NoneType&apos;</div>","workflows":[],"startTime":1519522500141,"submitTime":1519522500127,"finishTime":1519522500261,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"03166517-0b9a-4e46-adb6-5d1af367458f"},{"version":"CommandV1","origId":601698659811130,"guid":"c4e3e656-7f94-4ac8-9be2-80a63432ea3d","subtype":"command","commandType":"auto","position":14.0,"command":"### Done preprocessing numeric data.\ndonor_df.select(donor_df.income).distinct().show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+------+\n|income|\n+------+\n|  &gt;50K|\n| &lt;=50K|\n+------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&quot;filter expression &apos;&#96;income&#96;&apos; of type string is not a boolean.;;\\nFilter income#153814: string\\n+- Project [age#154192, workclass#153738, education_level#153739, ((education_num#153898 - 0) - 1) AS education_num#154256, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, capital_gain#154224, capital_loss#154208, hours_per_week#154240, native_country#153978, income#153814]\\n   +- Project [age#154192, workclass#153738, education_level#153739, education_num#153898, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, capital_gain#154224, capital_loss#154208, ((hours_per_week#153962 - 0) - 1) AS hours_per_week#154240, native_country#153978, income#153814]\\n      +- Project [age#154192, workclass#153738, education_level#153739, education_num#153898, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, ((capital_gain#154090 - 0.0) - 0.0) AS capital_gain#154224, capital_loss#154208, hours_per_week#153962, native_country#153978, income#153814]\\n         +- Project [age#154192, workclass#153738, education_level#153739, education_num#153898, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, capital_gain#154090, ((capital_loss#154106 - 0.0) - 0.0) AS capital_loss#154208, hours_per_week#153962, native_country#153978, income#153814]\\n            +- Project [((age#153737 - 0) - 17) AS age#154192, workclass#153738, education_level#153739, education_num#153898, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, capital_gain#154090, capital_loss#154106, hours_per_week#153962, native_country#153978, income#153814]\\n               +- Project [age#153737, workclass#153738, education_level#153739, education_num#153898, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, capital_gain#154090, LOG(cast((capital_loss#153946 + 1) as double)) AS capital_loss#154106, hours_per_week#153962, native_country#153978, income#153814]\\n                  +- Project [age#153737, workclass#153738, education_level#153739, education_num#153898, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, LOG(cast((capital_gain#153930 + 1) as double)) AS capital_gain#154090, capital_loss#153946, hours_per_week#153962, native_country#153978, income#153814]\\n                     +- Project [age#153737, workclass#153738, education_level#153739, education_num#153898, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, capital_gain#153930, capital_loss#153946, hours_per_week#153962, native-country#153749 AS native_country#153978, income#153814]\\n                        +- Project [age#153737, workclass#153738, education_level#153739, education_num#153898, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, capital_gain#153930, capital_loss#153946, hours-per-week#153748 AS hours_per_week#153962, native-country#153749, income#153814]\\n                           +- Project [age#153737, workclass#153738, education_level#153739, education_num#153898, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, capital_gain#153930, capital-loss#153747 AS capital_loss#153946, hours-per-week#153748, native-country#153749, income#153814]\\n                              +- Project [age#153737, workclass#153738, education_level#153739, education_num#153898, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, capital-gain#153746 AS capital_gain#153930, capital-loss#153747, hours-per-week#153748, native-country#153749, income#153814]\\n                                 +- Project [age#153737, workclass#153738, education_level#153739, education_num#153898, marital-status#153741 AS marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, capital-gain#153746, capital-loss#153747, hours-per-week#153748, native-country#153749, income#153814]\\n                                    +- Project [age#153737, workclass#153738, education_level#153739, education-num#153740 AS education_num#153898, marital-status#153741, occupation#153742, relationship#153743, race#153744, sex#153745, capital-gain#153746, capital-loss#153747, hours-per-week#153748, native-country#153749, income#153814]\\n                                       +- Project [age#153737, workclass#153738, education_level#153739, education-num#153740, marital-status#153741, occupation#153742, relationship#153743, race#153744, sex#153745, capital-gain#153746, capital-loss#153747, hours-per-week#153748, native-country#153749, regexp_replace(income#153798, &lt;=50K., &lt;=50K) AS income#153814]\\n                                          +- Project [age#153737, workclass#153738, education_level#153739, education-num#153740, marital-status#153741, occupation#153742, relationship#153743, race#153744, sex#153745, capital-gain#153746, capital-loss#153747, hours-per-week#153748, native-country#153749, regexp_replace(income#153750, &gt;50K., &gt;50K) AS income#153798]\\n                                             +- Filter isnotnull(income#153750)\\n                                                +- Filter isnotnull(income#153750)\\n                                                   +- Relation[age#153737,workclass#153738,education_level#153739,education-num#153740,marital-status#153741,occupation#153742,relationship#153743,race#153744,sex#153745,capital-gain#153746,capital-loss#153747,hours-per-week#153748,native-country#153749,income#153750] csv\\n&quot;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-284-73341d81189d&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\">### Done preprocessing numeric data.</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>donor_df<span class=\"ansiyellow\">.</span>filter<span class=\"ansiyellow\">(</span>donor_df<span class=\"ansiyellow\">.</span>income<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.py</span> in <span class=\"ansicyan\">filter</span><span class=\"ansiblue\">(self, condition)</span>\n<span class=\"ansigreen\">    916</span>             jdf <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>filter<span class=\"ansiyellow\">(</span>condition<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    917</span>         <span class=\"ansigreen\">elif</span> isinstance<span class=\"ansiyellow\">(</span>condition<span class=\"ansiyellow\">,</span> Column<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 918</span><span class=\"ansiyellow\">             </span>jdf <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>filter<span class=\"ansiyellow\">(</span>condition<span class=\"ansiyellow\">.</span>_jc<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    919</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    920</span>             <span class=\"ansigreen\">raise</span> TypeError<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;condition should be string or Column&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.3-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     67</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&quot;filter expression &apos;&#96;income&#96;&apos; of type string is not a boolean.;;\\nFilter income#153814: string\\n+- Project [age#154192, workclass#153738, education_level#153739, ((education_num#153898 - 0) - 1) AS education_num#154256, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, capital_gain#154224, capital_loss#154208, hours_per_week#154240, native_country#153978, income#153814]\\n   +- Project [age#154192, workclass#153738, education_level#153739, education_num#153898, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, capital_gain#154224, capital_loss#154208, ((hours_per_week#153962 - 0) - 1) AS hours_per_week#154240, native_country#153978, income#153814]\\n      +- Project [age#154192, workclass#153738, education_level#153739, education_num#153898, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, ((capital_gain#154090 - 0.0) - 0.0) AS capital_gain#154224, capital_loss#154208, hours_per_week#153962, native_country#153978, income#153814]\\n         +- Project [age#154192, workclass#153738, education_level#153739, education_num#153898, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, capital_gain#154090, ((capital_loss#154106 - 0.0) - 0.0) AS capital_loss#154208, hours_per_week#153962, native_country#153978, income#153814]\\n            +- Project [((age#153737 - 0) - 17) AS age#154192, workclass#153738, education_level#153739, education_num#153898, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, capital_gain#154090, capital_loss#154106, hours_per_week#153962, native_country#153978, income#153814]\\n               +- Project [age#153737, workclass#153738, education_level#153739, education_num#153898, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, capital_gain#154090, LOG(cast((capital_loss#153946 + 1) as double)) AS capital_loss#154106, hours_per_week#153962, native_country#153978, income#153814]\\n                  +- Project [age#153737, workclass#153738, education_level#153739, education_num#153898, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, LOG(cast((capital_gain#153930 + 1) as double)) AS capital_gain#154090, capital_loss#153946, hours_per_week#153962, native_country#153978, income#153814]\\n                     +- Project [age#153737, workclass#153738, education_level#153739, education_num#153898, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, capital_gain#153930, capital_loss#153946, hours_per_week#153962, native-country#153749 AS native_country#153978, income#153814]\\n                        +- Project [age#153737, workclass#153738, education_level#153739, education_num#153898, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, capital_gain#153930, capital_loss#153946, hours-per-week#153748 AS hours_per_week#153962, native-country#153749, income#153814]\\n                           +- Project [age#153737, workclass#153738, education_level#153739, education_num#153898, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, capital_gain#153930, capital-loss#153747 AS capital_loss#153946, hours-per-week#153748, native-country#153749, income#153814]\\n                              +- Project [age#153737, workclass#153738, education_level#153739, education_num#153898, marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, capital-gain#153746 AS capital_gain#153930, capital-loss#153747, hours-per-week#153748, native-country#153749, income#153814]\\n                                 +- Project [age#153737, workclass#153738, education_level#153739, education_num#153898, marital-status#153741 AS marital_status#153914, occupation#153742, relationship#153743, race#153744, sex#153745, capital-gain#153746, capital-loss#153747, hours-per-week#153748, native-country#153749, income#153814]\\n                                    +- Project [age#153737, workclass#153738, education_level#153739, education-num#153740 AS education_num#153898, marital-status#153741, occupation#153742, relationship#153743, race#153744, sex#153745, capital-gain#153746, capital-loss#153747, hours-per-week#153748, native-country#153749, income#153814]\\n                                       +- Project [age#153737, workclass#153738, education_level#153739, education-num#153740, marital-status#153741, occupation#153742, relationship#153743, race#153744, sex#153745, capital-gain#153746, capital-loss#153747, hours-per-week#153748, native-country#153749, regexp_replace(income#153798, &lt;=50K., &lt;=50K) AS income#153814]\\n                                          +- Project [age#153737, workclass#153738, education_level#153739, education-num#153740, marital-status#153741, occupation#153742, relationship#153743, race#153744, sex#153745, capital-gain#153746, capital-loss#153747, hours-per-week#153748, native-country#153749, regexp_replace(income#153750, &gt;50K., &gt;50K) AS income#153798]\\n                                             +- Filter isnotnull(income#153750)\\n                                                +- Filter isnotnull(income#153750)\\n                                                   +- Relation[age#153737,workclass#153738,education_level#153739,education-num#153740,marital-status#153741,occupation#153742,relationship#153743,race#153744,sex#153745,capital-gain#153746,capital-loss#153747,hours-per-week#153748,native-country#153749,income#153750] csv\\n&quot;</div>","workflows":[],"startTime":1519522500271,"submitTime":1519522500261,"finishTime":1519522501095,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2da6959e-ea4d-4dbc-a0d5-2c7c8fcd08d4"},{"version":"CommandV1","origId":601698659811139,"guid":"9259f9c3-919f-4c84-b9f5-1d49b70b5515","subtype":"command","commandType":"auto","position":14.5,"command":"indexer = StringIndexer(inputCol = 'income', outputCol = 'income_index')\ndonor_df= indexer.fit(donor_df).transform(donor_df)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519522501100,"submitTime":1519522500386,"finishTime":1519522501631,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fd7429e5-110a-48d7-a9b7-71e08e7f89d3"},{"version":"CommandV1","origId":601698659811131,"guid":"444d36eb-5ad6-467c-a85c-521dcd263cdf","subtype":"command","commandType":"auto","position":15.0,"command":"categorical_df = ['workclass','education_level','marital_status','occupation','relationship','race','sex','native_country']\nfor category in categorical_df:\n    indexer = StringIndexer(inputCol = category, outputCol = category+'_index')\n    donor_df = indexer.fit(donor_df).transform(donor_df)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519522501635,"submitTime":1519522500506,"finishTime":1519522505053,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8ed46c9a-db2d-45a0-bb33-58756d354ac3"},{"version":"CommandV1","origId":601698659811134,"guid":"a7a13cd1-415e-49fe-9eed-bddd878020b6","subtype":"command","commandType":"auto","position":16.0,"command":"for category in categorical_df:\n    encoder = OneHotEncoder(inputCol = category+'_index', outputCol = category+'_encoded' )\n    donor_df = encoder.transform(donor_df)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519522505056,"submitTime":1519522500632,"finishTime":1519522505528,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a3a64855-3c73-4b56-820c-a6dfa31d9d2d"},{"version":"CommandV1","origId":601698659811135,"guid":"28e884be-dcf0-4a0f-978f-1dc65d22325a","subtype":"command","commandType":"auto","position":17.0,"command":"donor_df.select('race_encoded','native_country_encoded','education_level_encoded').show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------------+----------------------+-----------------------+\n| race_encoded|native_country_encoded|education_level_encoded|\n+-------------+----------------------+-----------------------+\n|(4,[0],[1.0])|        (41,[0],[1.0])|         (15,[2],[1.0])|\n|(4,[0],[1.0])|        (41,[0],[1.0])|         (15,[2],[1.0])|\n|(4,[0],[1.0])|        (41,[0],[1.0])|         (15,[0],[1.0])|\n|(4,[1],[1.0])|        (41,[0],[1.0])|         (15,[5],[1.0])|\n|(4,[1],[1.0])|        (41,[9],[1.0])|         (15,[2],[1.0])|\n|(4,[0],[1.0])|        (41,[0],[1.0])|         (15,[3],[1.0])|\n|(4,[1],[1.0])|       (41,[13],[1.0])|        (15,[10],[1.0])|\n|(4,[0],[1.0])|        (41,[0],[1.0])|         (15,[0],[1.0])|\n|(4,[0],[1.0])|        (41,[0],[1.0])|         (15,[3],[1.0])|\n|(4,[0],[1.0])|        (41,[0],[1.0])|         (15,[2],[1.0])|\n|(4,[1],[1.0])|        (41,[0],[1.0])|         (15,[1],[1.0])|\n|(4,[2],[1.0])|        (41,[8],[1.0])|         (15,[2],[1.0])|\n|(4,[0],[1.0])|        (41,[0],[1.0])|         (15,[2],[1.0])|\n|(4,[1],[1.0])|        (41,[0],[1.0])|         (15,[6],[1.0])|\n|(4,[2],[1.0])|        (41,[2],[1.0])|         (15,[4],[1.0])|\n|(4,[3],[1.0])|        (41,[1],[1.0])|         (15,[8],[1.0])|\n|(4,[0],[1.0])|        (41,[0],[1.0])|         (15,[0],[1.0])|\n|(4,[0],[1.0])|        (41,[0],[1.0])|         (15,[0],[1.0])|\n|(4,[0],[1.0])|        (41,[0],[1.0])|         (15,[5],[1.0])|\n|(4,[0],[1.0])|        (41,[0],[1.0])|         (15,[3],[1.0])|\n+-------------+----------------------+-----------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519522505532,"submitTime":1519522500774,"finishTime":1519522505804,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0bae586e-bf94-4091-aeac-d1c5b5327609"},{"version":"CommandV1","origId":601698659811138,"guid":"bb40253c-6d14-40a0-9423-ec551525cd65","subtype":"command","commandType":"auto","position":17.5,"command":"donor_df.columns","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">293</span><span class=\"ansired\">]: </span>\n[&apos;age&apos;,\n &apos;workclass&apos;,\n &apos;education_level&apos;,\n &apos;education_num&apos;,\n &apos;marital_status&apos;,\n &apos;occupation&apos;,\n &apos;relationship&apos;,\n &apos;race&apos;,\n &apos;sex&apos;,\n &apos;capital_gain&apos;,\n &apos;capital_loss&apos;,\n &apos;hours_per_week&apos;,\n &apos;native_country&apos;,\n &apos;income&apos;,\n &apos;income_index&apos;,\n &apos;workclass_index&apos;,\n &apos;education_level_index&apos;,\n &apos;marital_status_index&apos;,\n &apos;occupation_index&apos;,\n &apos;relationship_index&apos;,\n &apos;race_index&apos;,\n &apos;sex_index&apos;,\n &apos;native_country_index&apos;,\n &apos;workclass_encoded&apos;,\n &apos;education_level_encoded&apos;,\n &apos;marital_status_encoded&apos;,\n &apos;occupation_encoded&apos;,\n &apos;relationship_encoded&apos;,\n &apos;race_encoded&apos;,\n &apos;sex_encoded&apos;,\n &apos;native_country_encoded&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519522505807,"submitTime":1519522500911,"finishTime":1519522505928,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"328f21dd-3161-4815-b7af-00cc839c08b8"},{"version":"CommandV1","origId":601698659811136,"guid":"62fb60f9-9444-4ef3-b209-41a33617c803","subtype":"command","commandType":"auto","position":18.0,"command":"assembler = VectorAssembler(inputCols=['age',\n  'education_num',\n  'capital_gain',\n 'capital_loss',\n 'hours_per_week',\n  'workclass_encoded',\n 'education_level_encoded',\n 'marital_status_encoded',\n 'occupation_encoded',\n 'relationship_encoded',\n 'race_encoded',\n 'sex_encoded',\n 'native_country_encoded'],outputCol='features')\ndonor_df = assembler.transform(donor_df)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519522505931,"submitTime":1519522501043,"finishTime":1519522506051,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5d317b25-89aa-4f00-a583-535e75b363e5"},{"version":"CommandV1","origId":601698659811137,"guid":"0fbc174d-5713-4e38-b4a9-3e027b31dcdf","subtype":"command","commandType":"auto","position":19.0,"command":"final_donor_df = donor_df.select('features','income_index')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519522506055,"submitTime":1519522501178,"finishTime":1519522506129,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1e7d008c-a789-4a07-9a03-90238b172fdb"},{"version":"CommandV1","origId":601698659811140,"guid":"31b218d2-91fb-4512-9813-5d19ad0db4ca","subtype":"command","commandType":"auto","position":20.0,"command":"final_donor_df = final_donor_df.withColumnRenamed('income_index','label')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519522506136,"submitTime":1519522501315,"finishTime":1519522506174,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"23623e8d-31af-4f5f-b47d-f9b2eadd75b3"},{"version":"CommandV1","origId":601698659811141,"guid":"1ded03c7-cd10-4dff-9786-74ae2b8f2f3a","subtype":"command","commandType":"auto","position":21.0,"command":"final_donor_train , final_donor_test = final_donor_df.randomSplit([0.7,0.3])\n\nfinal_donor_train.show(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------------------+-----+\n|            features|label|\n+--------------------+-----+\n|(99,[0,1,2,4,5,13...|  1.0|\n|(99,[0,1,2,4,5,13...|  1.0|\n|(99,[0,1,2,4,5,13...|  1.0|\n|(99,[0,1,2,4,5,13...|  1.0|\n|(99,[0,1,2,4,5,13...|  0.0|\n+--------------------+-----+\nonly showing top 5 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519522506178,"submitTime":1519522501450,"finishTime":1519522508095,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"96ea9ca4-aace-4cee-ad44-0990261b0fd2"},{"version":"CommandV1","origId":601698659811142,"guid":"3cc0a934-147d-4292-af2e-2b5824889228","subtype":"command","commandType":"auto","position":22.0,"command":"from pyspark.ml.classification import LogisticRegression, NaiveBayes, DecisionTreeClassifier,RandomForestClassifier, GBTClassifier\nfrom pyspark.ml.tuning import CrossValidator,ParamGridBuilder\nfrom pyspark.ml.evaluation import BinaryClassificationEvaluator","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519522508099,"submitTime":1519522501586,"finishTime":1519522508138,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e18719ff-44cc-4274-b1ad-06bfc7e767d7"},{"version":"CommandV1","origId":601698659811143,"guid":"c23f95ae-af21-459a-8ce7-17519a3bc446","subtype":"command","commandType":"auto","position":23.0,"command":"lrc = LogisticRegression(maxIter=10)  ## regParam=0.3, elasticNetParam=0.8\ndtc = DecisionTreeClassifier(labelCol='label',featuresCol='features')\nrfc = RandomForestClassifier(labelCol='label',featuresCol='features')  ### numTrees=10\ngbt = GBTClassifier(labelCol='label',featuresCol='features',maxIter=10)  ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519522508141,"submitTime":1519522501721,"finishTime":1519522508211,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1ee2fff4-0c6d-471f-b982-aa60de3c6821"},{"version":"CommandV1","origId":4401295299595934,"guid":"93d12447-96b3-4531-aed8-f7c106f2897b","subtype":"command","commandType":"auto","position":23.5,"command":"bin_eval = BinaryClassificationEvaluator(labelCol='label')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519522508215,"submitTime":1519522501856,"finishTime":1519522508285,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"14994200-a12c-4526-ba54-e3b048ec6174"},{"version":"CommandV1","origId":601698659811144,"guid":"bbd6005b-fee5-4c0e-9e04-2e8df8994a78","subtype":"command","commandType":"auto","position":24.0,"command":"params = ParamGridBuilder().addGrid(lrc.regParam, [0.1,0.01]).addGrid(lrc.elasticNetParam, [0,1]).addGrid(dtc.maxDepth, [1,5]).addGrid(rfc.numTrees, [1,10]).build()\nparams_dtc = ParamGridBuilder().addGrid(dtc.maxDepth, [1,5]).build()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519522508288,"submitTime":1519522502001,"finishTime":1519522508359,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ec788f6c-67fd-482e-8ac3-074f908d4549"},{"version":"CommandV1","origId":601698659811145,"guid":"8311d560-c7e1-4375-a8c4-d90e2a6234d9","subtype":"command","commandType":"auto","position":25.0,"command":"### Hyper parameter tuning and model selection\nestimators = ['lrc','rfc','dtc','gbt']\n\nfor clf in estimators:\n    cross_model = CrossValidator(estimator=dtc,estimatorParamMaps=params,evaluator=bin_eval,numFolds=5)\n    cv_model = cross_model.fit(final_donor_train)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519522508363,"submitTime":1519522502164,"finishTime":1519524546775,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"730c4daf-57d6-40f8-8abb-54a237ac61a6"},{"version":"CommandV1","origId":4401295299595932,"guid":"4c5ab81a-8e0b-4693-bacb-18219105d1cc","subtype":"command","commandType":"auto","position":27.0,"command":"print('Best estimator is: ',cv_model.getEstimator())\nprint('Best estimator parameters: ',cv_model.bestModel)\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(&apos;Best estimator is: &apos;, DecisionTreeClassifier_4f91ad13fdcd3f4c62c5)\n(&apos;Best estimator parameters: &apos;, DecisionTreeClassificationModel (uid=DecisionTreeClassifier_4f91ad13fdcd3f4c62c5) of depth 1 with 3 nodes)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519525488298,"submitTime":1519525488289,"finishTime":1519525488369,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1fec9ccf-4ab1-48f8-9996-b318b74a9542"},{"version":"CommandV1","origId":4401295299595933,"guid":"b3f19a49-fd52-45f6-9bbb-38e4007a409a","subtype":"command","commandType":"auto","position":28.0,"command":"### Making predictions on unseen test data with the best classifier.\ntest_preds = cv_model.transform(final_donor_test)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519525489167,"submitTime":1519525489152,"finishTime":1519525489439,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c634953e-9140-4dc8-825d-82ed454c0684"},{"version":"CommandV1","origId":4401295299595935,"guid":"70fea134-b0dc-40c9-8204-3a04ddeb50ab","subtype":"command","commandType":"auto","position":29.0,"command":"test_preds.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------------------+-----+---------------+--------------------+----------+\n|            features|label|  rawPrediction|         probability|prediction|\n+--------------------+-----+---------------+--------------------+----------+\n|(99,[0,1,2,4,5,13...|  1.0|[8714.0,6997.0]|[0.55464324358729...|       0.0|\n|(99,[0,1,2,4,5,13...|  1.0|[8714.0,6997.0]|[0.55464324358729...|       0.0|\n|(99,[0,1,2,4,5,13...|  1.0|[8714.0,6997.0]|[0.55464324358729...|       0.0|\n|(99,[0,1,2,4,5,13...|  1.0|[8714.0,6997.0]|[0.55464324358729...|       0.0|\n|(99,[0,1,2,4,5,13...|  0.0|[8714.0,6997.0]|[0.55464324358729...|       0.0|\n|(99,[0,1,2,4,5,13...|  1.0|[8714.0,6997.0]|[0.55464324358729...|       0.0|\n|(99,[0,1,2,4,5,13...|  0.0|[8714.0,6997.0]|[0.55464324358729...|       0.0|\n|(99,[0,1,2,4,5,13...|  0.0|[8714.0,6997.0]|[0.55464324358729...|       0.0|\n|(99,[0,1,2,4,5,13...|  1.0|[8714.0,6997.0]|[0.55464324358729...|       0.0|\n|(99,[0,1,2,4,5,13...|  0.0|[8714.0,6997.0]|[0.55464324358729...|       0.0|\n|(99,[0,1,2,4,5,13...|  0.0|[8714.0,6997.0]|[0.55464324358729...|       0.0|\n|(99,[0,1,2,4,5,13...|  0.0|[8714.0,6997.0]|[0.55464324358729...|       0.0|\n|(99,[0,1,2,4,5,13...|  1.0|[8714.0,6997.0]|[0.55464324358729...|       0.0|\n|(99,[0,1,2,4,5,13...|  0.0|[8714.0,6997.0]|[0.55464324358729...|       0.0|\n|(99,[0,1,2,4,5,13...|  0.0|[8714.0,6997.0]|[0.55464324358729...|       0.0|\n|(99,[0,1,2,4,5,13...|  1.0|[8714.0,6997.0]|[0.55464324358729...|       0.0|\n|(99,[0,1,2,4,5,13...|  1.0|[8714.0,6997.0]|[0.55464324358729...|       0.0|\n|(99,[0,1,2,4,5,13...|  1.0|[8714.0,6997.0]|[0.55464324358729...|       0.0|\n|(99,[0,1,2,4,5,13...|  1.0|[8714.0,6997.0]|[0.55464324358729...|       0.0|\n|(99,[0,1,2,4,5,13...|  1.0|[8714.0,6997.0]|[0.55464324358729...|       0.0|\n+--------------------+-----+---------------+--------------------+----------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519525492953,"submitTime":1519525492938,"finishTime":1519525494965,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"79394e20-3243-402f-9686-d7e64129b76a"},{"version":"CommandV1","origId":4401295299595936,"guid":"915cb668-f58d-41cb-906f-06aceee65b3f","subtype":"command","commandType":"auto","position":30.0,"command":"evaluator = BinaryClassificationEvaluator(labelCol='label')\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519525494969,"submitTime":1519525494906,"finishTime":1519525495007,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"95b6866f-8616-47e2-8dbf-f526e6909fb5"},{"version":"CommandV1","origId":4401295299595937,"guid":"85cda377-4928-4353-a213-3b2d4fab8446","subtype":"command","commandType":"auto","position":31.0,"command":"metrics = evaluator.evaluate(test_preds,{evaluator.metricName:'areaUnderROC'})","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519525495738,"submitTime":1519525495722,"finishTime":1519525497450,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"81b2a4f3-2984-43b1-8b01-5ab5c9941977"},{"version":"CommandV1","origId":4401295299595938,"guid":"b2279fc8-3891-4739-873b-31003d53a293","subtype":"command","commandType":"auto","position":32.0,"command":"print('Area under ROC curve: {0:.2f}'.format(metrics))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Area under ROC curve: 0.77\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519525497454,"submitTime":1519525496581,"finishTime":1519525497495,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f96bca69-831a-4298-b26a-3b1afa6e46c9"}],"dashboards":[],"guid":"839044a1-49e7-42fa-8034-fe371f76c40c","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/f12a05aa7eae95a2da8fd637b50b850a1bb31a04ce331f5b43445dd4cda0ff19/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/f12a05aa7eae95a2da8fd637b50b850a1bb31a04ce331f5b43445dd4cda0ff19/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
